\input{preambolo_comune}

% --- Titolo ---
\title{Variabili Aleatorie Discrete}
\author{Basato sulle prove d'esame}
\date{\today}

\begin{document}

\maketitle
\tableofcontents
\newpage

\label{cap:va_discrete}
% ... contenuto del capitolo ...
Una variabile aleatoria (v.a.) è una funzione che associa un numero reale a ogni esito di un esperimento aleatorio. Ci permette di passare da descrizioni qualitative a quantitative.

\begin{definition}[Variabile Aleatoria Discreta]
Una variabile aleatoria $X$ si dice \textbf{discreta} se l'insieme dei valori che può assumere (chiamato \textbf{supporto} $S_X$) è un insieme finito o numerabile (cioè i suoi elementi possono essere messi in corrispondenza biunivoca con i numeri naturali).
\end{definition}

\begin{example}
\begin{itemize}
    \item $X = $ numero di Teste in 3 lanci di una moneta. $S_X = \{0, 1, 2, 3\}$.
    \item $Y = $ risultato del lancio di un dado. $S_Y = \{1, 2, 3, 4, 5, 6\}$.
    \item $Z = $ numero di tentativi fino al primo successo in una serie di prove. $S_Z = \{1, 2, 3, \dots\}$. (Numerabile infinito)
    \item \textbf{Esercizio 3, 08/09/2023:} $X$ è una v.a. con $S_X = \{0, 2, 5\}$.
\end{itemize}
\end{example}

\section{Funzione di Massa di Probabilità (PMF)}
\begin{definition}[Funzione di Massa di Probabilità]
Per una v.a. discreta $X$, la \textbf{funzione di massa di probabilità} (PMF), indicata con $p_X(k)$ o $\Prob(X=k)$, assegna a ogni possibile valore $k$ del supporto $S_X$ la probabilità che $X$ assuma quel valore:
\[ p_X(k) = \Prob(X=k) \]
La PMF deve soddisfare:
\begin{enumerate}
    \item $p_X(k) \ge 0$ per ogni $k \in S_X$.
    \item $\sum_{k \in S_X} p_X(k) = 1$.
    \item $p_X(k) = 0$ se $k \notin S_X$.
\end{enumerate}
\end{definition}

\section{Funzione di Ripartizione (CDF)}
\begin{definition}[Funzione di Ripartizione]
La \textbf{funzione di ripartizione} (CDF) di una v.a. $X$ (discreta o continua), indicata con $F_X(x)$, è definita per ogni $x \in \R$ come:
\[ F_X(x) = \Prob(X \le x) \]
Per una v.a. discreta, $F_X(x) = \sum_{k \le x, k \in S_X} p_X(k)$.
Proprietà della CDF:
\begin{enumerate}
    \item $F_X(x)$ è non decrescente: se $x_1 < x_2$, allora $F_X(x_1) \le F_X(x_2)$.
    \item $\lim_{x \to -\infty} F_X(x) = 0$.
    \item $\lim_{x \to +\infty} F_X(x) = 1$.
    \item $F_X(x)$ è continua da destra: $\lim_{h \to 0^+} F_X(x+h) = F_X(x)$.
    \item Per una v.a. discreta, $F_X(x)$ è una funzione a gradini. I salti avvengono nei punti $k \in S_X$ e l'altezza del salto in $k$ è $p_X(k)$.
    \item $\Prob(a < X \le b) = F_X(b) - F_X(a)$.
    \item $\Prob(X=k) = F_X(k) - F_X(k^-)$ (dove $F_X(k^-) = \lim_{x \to k^-} F_X(x)$).
\end{enumerate}
\end{definition}

\begin{example}[Esercizio 3, Punto 1, 08/09/2023]
$S_X = \{0, 2, 5\}$, $E[X]=2$, $\Var(X)=2$. Determinare la funzione di ripartizione.
\textit{Soluzione Passo Passo:}
\begin{enumerate}
    \item \textbf{Impostare il sistema di equazioni:}
    Siano $p_0 = \Prob(X=0)$, $p_2 = \Prob(X=2)$, $p_5 = \Prob(X=5)$.
    Sappiamo che:
    \begin{itemize}
        \item $p_0 + p_2 + p_5 = 1$ (la somma delle probabilità è 1).
        \item $E[X] = 0 \cdot p_0 + 2 \cdot p_2 + 5 \cdot p_5 = 2p_2 + 5p_5 = 2$.
        \item $\Var(X) = E[X^2] - (E[X])^2 = 2$.
          $E[X^2] = 0^2 p_0 + 2^2 p_2 + 5^2 p_5 = 4p_2 + 25p_5$.
          Quindi, $4p_2 + 25p_5 - (2)^2 = 2 \Rightarrow 4p_2 + 25p_5 - 4 = 2 \Rightarrow 4p_2 + 25p_5 = 6$.
    \end{itemize}
    Abbiamo il sistema:
    \begin{align*}
        p_0 + p_2 + p_5 &= 1 \\
        2p_2 + 5p_5 &= 2 \\
        4p_2 + 25p_5 &= 6
    \end{align*}
    \item \textbf{Risolvere il sistema per $p_2, p_5$ (ultime due equazioni):}
    Dalla seconda: $2p_2 = 2 - 5p_5 \Rightarrow p_2 = 1 - \frac{5}{2}p_5$.
    Sostituisci nella terza: $4(1 - \frac{5}{2}p_5) + 25p_5 = 6$
    $4 - 10p_5 + 25p_5 = 6 \Rightarrow 15p_5 = 2 \Rightarrow p_5 = 2/15$.
    Sostituisci $p_5$ per trovare $p_2$: $p_2 = 1 - \frac{5}{2}(\frac{2}{15}) = 1 - \frac{1}{3} = 2/3$.
    \item \textbf{Trovare $p_0$ dalla prima equazione:}
    $p_0 + 2/3 + 2/15 = 1 \Rightarrow p_0 = 1 - 2/3 - 2/15 = 1 - 10/15 - 2/15 = 1 - 12/15 = 3/15 = 1/5$.
    Quindi, la PMF è: $\Prob(X=0)=1/5$, $\Prob(X=2)=2/3$, $\Prob(X=5)=2/15$.
    Verifica: $1/5 + 2/3 + 2/15 = (3+10+2)/15 = 15/15=1$. Corretto.
    \item \textbf{Scrivere la Funzione di Ripartizione $F_X(x)$:}
    $F_X(x)$ è una funzione a gradini:
    \begin{itemize}
        \item Se $x < 0$, $F_X(x) = \Prob(X \le x) = 0$.
        \item Se $0 \le x < 2$, $F_X(x) = \Prob(X=0) = 1/5$.
        \item Se $2 \le x < 5$, $F_X(x) = \Prob(X=0) + \Prob(X=2) = 1/5 + 2/3 = 3/15 + 10/15 = 13/15$.
        \item Se $x \ge 5$, $F_X(x) = \Prob(X=0) + \Prob(X=2) + \Prob(X=5) = 1/5 + 2/3 + 2/15 = 1$.
    \end{itemize}
    Quindi:
    \[ F_X(x) = \begin{cases} 0 & \text{se } x < 0 \\ 1/5 & \text{se } 0 \le x < 2 \\ 13/15 & \text{se } 2 \le x < 5 \\ 1 & \text{se } x \ge 5 \end{cases} \]
    Questo corrisponde alla soluzione fornita.
\end{enumerate}
\end{example}

\section{Valore Atteso (Media) e Varianza}
\begin{definition}[Valore Atteso]
Il \textbf{valore atteso} (o media) di una v.a. discreta $X$, indicato con $\E[X]$ (o $\mu_X$), è:
\[ \E[X] = \sum_{k \in S_X} k \cdot p_X(k) \]
Rappresenta il valore medio che ci si aspetta di osservare per $X$ su un gran numero di ripetizioni dell'esperimento.
Se $g(X)$ è una funzione di $X$, allora $\E[g(X)] = \sum_{k \in S_X} g(k) \cdot p_X(k)$.
Proprietà (Linearità): $\E[aX+b] = a\E[X]+b$ per costanti $a,b$.
$\E[X+Y] = \E[X]+\E[Y]$ (anche se $X,Y$ non sono indipendenti).
\end{definition}

\begin{definition}[Varianza]
La \textbf{varianza} di una v.a. $X$, indicata con $\Var(X)$ (o $\sigma_X^2$), misura la dispersione dei valori di $X$ attorno alla sua media $\E[X]$:
\[ \Var(X) = \E[(X - \E[X])^2] = \sum_{k \in S_X} (k - \E[X])^2 p_X(k) \]
Una formula computazionalmente più comoda è:
\[ \Var(X) = \E[X^2] - (\E[X])^2 \]
dove $\E[X^2] = \sum_{k \in S_X} k^2 p_X(k)$.
Proprietà:
\begin{itemize}
    \item $\Var(X) \ge 0$.
    \item $\Var(aX+b) = a^2 \Var(X)$ per costanti $a,b$.
    \item Se $X, Y$ sono indipendenti, $\Var(X+Y) = \Var(X) + \Var(Y)$.
\end{itemize}
La \textbf{deviazione standard} $\sigma_X = \sqrt{\Var(X)}$ ha la stessa unità di misura di $X$.
\end{definition}

\section{Principali Distribuzioni Discrete}
Vediamo le distribuzioni che appaiono più frequentemente negli esercizi.

\subsection{Distribuzione di Bernoulli \texorpdfstring{$X \sim \text{Be}(p)$}{X ~ Be(p)}}
Descrive un esperimento con due soli esiti: "successo" (valore 1) e "insuccesso" (valore 0).
$S_X = \{0, 1\}$.
PMF: $\Prob(X=1) = p$, $\Prob(X=0) = 1-p = q$.
$\E[X] = p$.
$\Var(X) = p(1-p) = pq$.

\subsection{Distribuzione Binomiale \texorpdfstring{$X \sim \text{Bin}(n,p)$}{X ~ Bin(n,p)}}
Descrive il numero di successi in $n$ prove di Bernoulli indipendenti, ognuna con probabilità di successo $p$.
$S_X = \{0, 1, \dots, n\}$.
PMF: $\Prob(X=k) = \binom{n}{k} p^k (1-p)^{n-k}$ per $k \in S_X$.
$\E[X] = np$.
$\Var(X) = np(1-p) = npq$.
\begin{example}[Esercizio 3, 19/06/2024 - Palline rosse]
\textit{Problema:} Un'urna inizialmente vuota. Si lancia $n$ volte una moneta (P(Testa)=p). Se esce Testa, si inserisce una pallina rossa, altrimenti verde. $X$ = numero di palline rosse nell'urna dopo $n$ lanci.
\textit{Soluzione:} Ogni lancio è una prova di Bernoulli: successo="esce Testa" (pallina rossa), insuccesso="esce Croce" (pallina verde). Le prove sono indipendenti.
Quindi $X$ segue una distribuzione Binomiale con parametri $n$ (numero di prove/lanci) e $p$ (probabilità di successo/Testa).
$\Prob(X=k) = \binom{n}{k} p^k (1-p)^{n-k}$ per $k \in \{0, 1, \dots, n\}$.
\end{example}

\subsection{Distribuzione Geometrica \texorpdfstring{$X \sim \text{Geo}(p)$}{X ~ Geo(p)}}
Descrive il numero di prove di Bernoulli indipendenti necessarie per ottenere il \textbf{primo} successo.
$S_X = \{1, 2, 3, \dots\}$.
PMF: $\Prob(X=k) = (1-p)^{k-1} p = q^{k-1}p$ per $k \in S_X$.
$\E[X] = 1/p$.
$\Var(X) = (1-p)/p^2 = q/p^2$.
Proprietà di assenza di memoria (per la versione che conta il numero di prove):
$\Prob(X > k+j | X > j) = \Prob(X > k)$.
CDF: $F_X(k) = \Prob(X \le k) = 1 - (1-p)^k = 1 - q^k$. (Questo è mostrato nell'Es. 3, 13/09/2024).

\begin{example}[Esercizio 2, 17/07/2024 - Gioco di Agata]
  % \textit{Problema (parte):} La distanza $T$ della bandierina è una v.a. geometrica di parametro $p=1/2$. Densità discreta $p_T(k) = P(T=k) = p(1-p)^{k-1} = (1/2)(1/2)^{k-1} = (1/2)^k$ per $k \in \N = \{1, 2, \dots\}$.
\textit{Problema (parte):} La distanza $T$ della bandierina è una v.a. geometrica di parametro $p=1/2$. Densità discreta $p_T(k) = P(T=k) = p(1-p)^{k-1} = (1/2)(1/2)^{k-1} = (1/2)^k$ per $k \in \mathbb{N} = \{1, 2, \dots\}$.
\end{example}

\subsection{Distribuzione di Poisson \texorpdfstring{$X \sim \text{Po}(\lambda)$}{X ~ Po(lambda)}}
Descrive il numero di eventi che si verificano in un intervallo di tempo o spazio fissato, quando questi eventi accadono con una frequenza media nota $\lambda$ e indipendentemente l'uno dall'altro.
$S_X = \{0, 1, 2, \dots\}$.
PMF: $\Prob(X=k) = e^{-\lambda} \frac{\lambda^k}{k!}$ per $k \in S_X$.
$\E[X] = \lambda$.
$\Var(X) = \lambda$.
La Binomiale $\text{Bin}(n,p)$ può essere approssimata da una Poisson $\text{Po}(\lambda=np)$ se $n$ è grande e $p$ è piccolo.

\begin{example}[Esercizio 3, Punto 2, 08/09/2023]
$Z$ è una v.a. di Poisson di parametro $\lambda=1$, indipendente da $X$.
Calcolare $\text{cov}(2X+Z, -X+3Z)$.
\textit{Soluzione Passo Passo:}
Ricordiamo la bilinearità della covarianza:
$\Cov(aX+bY, cU+dV) = ac \Cov(X,U) + ad \Cov(X,V) + bc \Cov(Y,U) + bd \Cov(Y,V)$.
Nel nostro caso:
$\Cov(2X+Z, -X+3Z) = \Cov(2X, -X) + \Cov(2X, 3Z) + \Cov(Z, -X) + \Cov(Z, 3Z)$
$= -2 \Cov(X,X) + 6 \Cov(X,Z) - \Cov(Z,X) + 3 \Cov(Z,Z)$
Ricordando che $\Cov(A,A) = \Var(A)$ e $\Cov(A,B) = \Cov(B,A)$:
$= -2 \Var(X) + (6-1) \Cov(X,Z) + 3 \Var(Z)$
$= -2 \Var(X) + 5 \Cov(X,Z) + 3 \Var(Z)$.
Dati del problema:
\begin{itemize}
    \item $\Var(X) = 2$ (calcolato/dato nel punto 1).
    \item $Z \sim \text{Po}(1)$, quindi $\E[Z]=1$ e $\Var(Z)=1$.
    \item $X$ e $Z$ sono indipendenti. Se due v.a. sono indipendenti, la loro covarianza è 0. Quindi $\Cov(X,Z)=0$.
\end{itemize}
Sostituendo:
$\Cov(2X+Z, -X+3Z) = -2(2) + 5(0) + 3(1) = -4 + 0 + 3 = -1$.
Questo corrisponde alla soluzione.
\end{example}

\subsection{Distribuzione Uniforme Discreta \texorpdfstring{$X \sim \text{Unif}\{x_1, \dots, x_n\}$}{X ~ Unif}}
Una v.a. $X$ assume $n$ valori distinti $\{x_1, \dots, x_n\}$ ciascuno con la stessa probabilità $1/n$.
$S_X = \{x_1, \dots, x_n\}$.
PMF: $\Prob(X=x_i) = 1/n$ per $i=1, \dots, n$.
Se $x_i = i$ per $i=1, \dots, n$:
$\E[X] = (n+1)/2$.
$\Var(X) = (n^2-1)/12$.
\begin{example}[Esercizio 1, 17/07/2024 - Lancio due dadi]
$X, Y \sim \text{Unif}\{1, 2, 3, 4, 5, 6\}$. Cioè $P(X=k)=1/6$ per $k \in \{1, ..., 6\}$, e lo stesso per $Y$.
\end{example}

% Continua con gli altri capitoli...
\end{document}
